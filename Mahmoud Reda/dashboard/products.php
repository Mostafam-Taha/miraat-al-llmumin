<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="../css/dashboard.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Kufi+Arabic:wght@100..900&family=Raleway:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        <title>Products | Cane</title>
        <link rel="icon" type="image/svg" sizes="32x32" href="../image/logo/basket.svg">
</head>
<body>
        <!-- Notifications -->
        <div class="overlay"></div>
    <div class="notifications-f">
        <div class="contanier">
            <div class="not-unread">
                <div class="not-check">
                    <h3>الأشعارات</h3>
                    <p>لديك <span>2</span> رسائل غير مقروءة</p>
                </div>
                <div class="not-icon-user">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check2-all" viewBox="0 0 16 16"><path d="M12.354 4.354a.5.5 0 0 0-.708-.708L5 10.293 1.854 7.146a.5.5 0 1 0-.708.708l3.5 3.5a.5.5 0 0 0 .708 0zm-4.208 7-.896-.897.707-.707.543.543 6.646-6.647a.5.5 0 0 1 .708.708l-7 7a.5.5 0 0 1-.708 0"/><path d="m5.354 7.146.896.897-.707.707-.897-.896a.5.5 0 1 1 .708-.708"/></svg>
                </div>
            </div>
            <hr>
            <div class="not-user">
                <div class="not-read-user">
                    <div class="not-image-user">
                        <img src="../image/Icon/Profile-icon-user.jpg" alt="لا توجد صورة مستخدم">
                    </div>
                    <div class="not-info-user">
                        <div class="not-order-user">
                            <p>أسم المستخدم <span>طلب المستخدم</span></p>
                        </div>
                        <div class="not-time-user">
                            <p>منذ <span> 1 </span>دقيقة <span><svg xmlns="http://www.w3.org/2000/svg"  fill="currentColor" class="bi bi-clock" viewBox="0 0 16 16"><path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"/><path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"/></svg></span></p>
                        </div>
                    </div>
                </div>
                <div class="not-read-user">
                    <div class="not-image-user">
                        <img src="../image/Icon/Profile-icon-user.jpg" alt="لا توجد صورة مستخدم">
                    </div>
                    <div class="not-info-user">
                        <div class="not-order-user">
                            <p>طلب المسخدم</p>
                        </div>
                        <div class="not-time-user">
                            <p>منذ <span> 1 </span>دقيقة <span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clock" viewBox="0 0 16 16"><path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"/><path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"/></svg></span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <header class="header">
        <div class="contanier">
            <div class="con-logo">
                <a href="../index.php">
                    <div class="logo">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-basket" viewBox="0 0 16 16">
                            <path d="M5.757 1.071a.5.5 0 0 1 .172.686L3.383 6h9.234L10.07 1.757a.5.5 0 1 1 .858-.514L13.783 6H15a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1v4.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 13.5V9a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h1.217L5.07 1.243a.5.5 0 0 1 .686-.172zM2 9v4.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V9zM1 7v1h14V7zm3 3a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3A.5.5 0 0 1 4 10m2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3A.5.5 0 0 1 6 10m2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3A.5.5 0 0 1 8 10m2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 1 .5-.5m2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 1 .5-.5"/>
                        </svg>
                        <h1>Cane</h1>
                    </div>
                </a>
            </div>
            <nav class="navbar">
                <ul class="nav-hed">
                    <li><a href=""><i class="bi bi-house"></i>لوحة القيادة</a></li>
                </ul>
                <div><span>إدارة المخازن</span></div>
                <ul class="nav-hed">
                    <li><a href=""><i class="bi bi-cart"></i>المنتجات</a></li>
                    <li><a href="#"><i class="bi bi-list-ul"></i>فئات</a></li>
                    <li><a href=""><i class="bi bi-bag"></i>اوامر</a></li>
                    <ul class="on-un-order-list">
                        <li><a href="">قائمة</a></li>
                        <li><a href="">فتورة</a></li>
                    </ul>
                    <li><a href=""><i class="bi bi-shop"></i>المحلات</a></li>
                    <li><a href=""><i class="bi bi-people-fill"></i>الزبائن</a></li>
                    <li><a href=""><i class="bi bi-star"></i>ملاحظات</a></li>
                </ul>
                <div><span>إعدادات الموقع</span></div>
                <ul class="nav-hed">
                    <li><a href=""><i class="bi bi-images"></i>وسائط</a></li>
                    <li><a href=""><i class="bi bi-gear"></i>إعدادات المتجر</a></li>
                </ul>
                <div><span>دعم</span></div>
                <ul class="nav-hed">
                    <li><a href=""><i class="bi bi-headphones"></i>تذكرة الدعم الفني</a></li>
                    <li><a href=""><i class="bi bi-question-circle"></i>مركز المساعدة</a></li>
                    <li><a href=""><i class="bi bi-infinity"></i>كيف يعمل Cane</a></li>
                </ul>
            </nav>
        </div>
    </header>
        <section class="order-list">
            <div class="contanier">
            <div class="profile-head">
                <div class="ft-show-profile">
                    <img src="../image/ads/slide-2.jpg" alt="لا توجد صورة الموظف">
                    <div class="ft-hied-bell">
                        <ul>
                            <li title="الأشعارات"><i class="bi bi-bell"></i></li>
                        </ul>
                    </div>
                </div>
                <div class="ft-search-profile">
                    <label for="search">
                        <input type="search" name="search" id="search" placeholder="بحث"/>
                    </label>
                </div>
            </div>
            <!--  -->
            <div class="ft-order-list">
                <div class="ft-contanier">
                    <div class="ft-table">
                        <div class="ft-name-order-list">
                            <div class="ft-name">
                                <h1>قائمة الطلبات</h1>
                            </div>
                            <div class="ft-link">
                                <label>
                                    <a href="">لوحة القيادة</a>
                                    <span>/</span>
                                    <a class="co-45" href="#">قائمة الطلبات</a>
                                </label>
                            </div>
                        </div>
                        <!--  -->
                        <div class="ft-story">
                            <div class="ft-search-story">
                                <label for="search-story">
                                    <input type="search" name="search-story" id="search-story" placeholder="بحث"/>
                                </label>
                            </div>
                            <div class="ft-story">
                                <button id="addproduct" >اضافة منتج</button>
                                <select class="status-select">
                                  <option value="story">حالة</option>
                                  <option value="success">نشط</option>
                                  <option value="pending">مسودة</option>
                                  <option value="chansl">معطل</option>
                                </select>
                            </div>
                        </div>
                        <!--  -->
                        <div class="ft-table-order-list">
                            <div class="ft-table-list">
                                <table>
                                    <thead>
                                        <tr>
                                            <th class="ft-co-40">
                                                <div class="ft-th-co95">
                                                    <input type="checkbox" id="checkbox-th" name="checkbox-th"/>
                                                    <label for="checkbox-th" class="custom-checkbox"></label>
                                                </div>                                                                                                  
                                            </th>
                                            <th class="ft-co-41"><div class="ft-th"><span>صورة</span></div></th>
                                            <th class="ft-co-42"><div class="ft-th"><span>اسم المنتج</span></div></th>
                                            <th class="ft-co-43"><div class="ft-th"><span>باب</span></div></th>
                                            <th class="ft-co-45"><div class="ft-th"><span>حالة</span></div></th>
                                            <th class="ft-co-44"><div class="ft-th"><span>ثمن</span></div></th>
                                            <th class="ft-co-46"><div class="ft-th"><span>إنشاء فى</span></div></th>
                                            <th class="ft-co-47"><div class="ft-th"><span></span></div></th>
                                        </tr>
                                    </thead>
                                    <?php
                                        // تضمين ملف الاتصال بقاعدة البيانات
                                        include('../php/config.php');

                                        // استعلام للحصول على بيانات المنتجات
                                        $query = "SELECT * FROM products";
                                        $result = mysqli_query($con, $query);

                                        // التحقق من أن الاستعلام نجح
                                        if (mysqli_num_rows($result) > 0) {
                                            // عرض البيانات في الجدول
                                            while ($row = mysqli_fetch_assoc($result)) {
                                                $image = $row['product_image'];       // صورة المنتج
                                                $name = $row['product_name'];         // اسم المنتج
                                                $category = $row['category'];         // فئة المنتج
                                                $status = $row['status'];             // حالة المنتج
                                                $price = $row['price'];               // ثمن المنتج
                                                $created_at = $row['created_at'];     // تاريخ الإنشاء
                                                ?>
                                                <tbody>
                                                    <tr>
                                                        <td>
                                                            <div class="ft-td">
                                                                <input type="checkbox" name="checkbox-td"/>
                                                                <label for="checkbox-td" class="checkbox-td"></label>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <div class="ft-td">
                                                                <!-- تحقق من وجود الصورة وعرضها إذا كانت موجودة -->
                                                                <?php 
                                                                    $imagePath = '../php/' . $image;
                                                                    if (file_exists($imagePath) && !empty($image)) {
                                                                        echo '<img src="' . $imagePath . '" alt="لا يوجد صورة منتج" width="50">';
                                                                    } else {
                                                                        echo '<img src="../php/uploads/exclamation-octagon.svg" alt="لا يوجد صورة منتج" width="50">';
                                                                    }
                                                                ?>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <div class="ft-td"><span><?php echo $name; ?></span></div>
                                                        </td>
                                                        <td>
                                                            <div class="ft-td"><span><?php echo $category; ?></span></div>
                                                        </td>
                                                        <td>
                                                            <div class="ft-td"><span><?php echo $status; ?></span></div>
                                                        </td>
                                                        <td>
                                                            <div class="ft-td"><span><?php echo $price; ?></span></div>
                                                        </td>
                                                        <td>
                                                            <div class="ft-td"><span><?php echo $created_at; ?></span></div>
                                                        </td>
                                                        <td>
                                                            <div class="ft-td">
                                                                <span class="toggle-menu" data-id="<?php echo $row['id']; ?>">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fs-5">
                                                                        <circle cx="12" cy="12" r="1"></circle>
                                                                        <circle cx="12" cy="5" r="1"></circle>
                                                                        <circle cx="12" cy="19" r="1"></circle>
                                                                    </svg>
                                                                </span>
                                                                <div class="row-t-co-456">
                                                                    <ul class="op-cro-table" style="display: none;" data-id="<?php echo $row['id']; ?>">
                                                                        <li>
                                                                            <a href="delete_product.php?id=<?php echo $row['id']; ?>" onclick="return confirm('هل أنت متأكد من حذف المنتج؟')">
                                                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                                                                                    <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"/>
                                                                                </svg>
                                                                                <span>حذف</span>
                                                                            </a>
                                                                        </li>
                                                                        <li>
                                                                            <a href="edit_product.php?id=<?php echo $row['id']; ?>">
                                                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                                                                    <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                                                                    <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"/>
                                                                                </svg>
                                                                                <span>تعديل</span>
                                                                            </a>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                                <?php
                                            }
                                        } else {
                                            echo "لا توجد منتجات لعرضها.";
                                        }

                                        // إغلاق الاتصال بقاعدة البيانات
                                        mysqli_close($con);
                                    ?>
                                </table>
                            </div>
                        </div>
                        <!--  -->
                        <div class="ft-footer-line"></div>
                        <div class="ft-footer">
                            <div class="ft-view">
                                <div class="ft-12">
                                    <p>عرض من 1 إلى 15 إدخالات</p>
                                </div>
                                <div class="ft-co-13">
                                    <div class="ft-co-btn">
                                        <button>السابق</button>
                                    </div>
                                    <div class="ft-co-14">
                                        <div class="ft-co-numper">
                                            <span>1</span>
                                            <span>2</span>
                                        </div>
                                    </div>
                                    <div class="ft-co-15">
                                        <div class="ft-co-btn">
                                            <button>التالي</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script>
        document.getElementById("addproduct").onclick = function () {
            window.location.href = "addproduct.html";
        }
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // التحقق من وجود العنصر وتحديد الإجراء عند الضغط
            document.querySelectorAll('.toggle-menu').forEach(function(element) {
                element.addEventListener('click', function(e) {
                    e.stopPropagation();  // لمنع التفاعل مع أي عنصر آخر

                    // العثور على العنصر الذي يحتوي على القائمة
                    const row = this.closest('td').querySelector('.ft-td');
                    const menu = row.querySelector('.op-cro-table');

                    // إغلاق جميع القوائم المفتوحة مسبقًا
                    document.querySelectorAll('.op-cro-table').forEach(function(openMenu) {
                        if (openMenu !== menu) {
                            openMenu.style.display = 'none'; // إخفاء القائمة الأخرى
                        }
                    });

                    // تبديل حالة الفئة active لإظهار أو إخفاء القائمة
                    menu.style.display = (menu.style.display === 'block') ? 'none' : 'block';
                });
            });

            // إغلاق القائمة المنبثقة عند النقر في أي مكان آخر
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.ft-td')) {
                    document.querySelectorAll('.op-cro-table').forEach(function(menu) {
                        menu.style.display = 'none';
                    });
                }
            });
        });

    </script>
</body>
</html>